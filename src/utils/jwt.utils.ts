import * as jwt from 'jsonwebtoken';

const privateKey = `-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----`;

const publicKey = `-----BEGIN PUBLIC KEY-----
MIIBojANBgkqhkiG9w0BAQEFAAOCAY8AMIIBigKCAYEA2ioiz7dsnbpMnLHaObxf
eZReYG7jQrntqVA5Gjrpbi5Wyg5G39wxDJ+Fmq08LD/X35Rhy0nqtbGYs9J9uQJh
UuNia1ai0pWkmwh13EVRqBoHsx60Sd7KyBvVnQKoR8DGoRx6JffbUVsvNPj6T7Mw
Utastk+R7h5uRhdYpQM6CTDBre2gBCRMt+ae5Bu28Lt/n7bX3K2WzYP1NNhR3ZHE
gUQTZOA+ET75O5QaHwVgVbWPgrjeSjAJxqN5w3n3sK9SYbCpwcm4P9TYwi2vTBSO
/i3vLo4tK3jTyc3G2VcBdVpHLJrw1bB1AqmFYbHqq4A5mvCfFW0JLPr/Il8VO2uB
YDOrW1RaAj+36CQ9/ksKjTckPigXw9kWmB0c4E28z9ezyuH6MTb0D3mF/ksxKmfJ
pf3EET/jrG2c8genEczkQE3mesaU1SneHgfCeYiEj36usVSmtt69iY/IO2ehDTNu
KzvR8MgDJaf1+aOyQHsZCfNsO6CVbS7tlxJ98gnfrMXLAgMBAAE=
-----END PUBLIC KEY-----`;

export const signJwt = (payload: string) => {
  return jwt.sign(payload, privateKey, { algorithm: 'RS256' });
};

export const decode = (token: string) => {
  if (!token) return null;
  try {
    const decoded = jwt.verify(token, publicKey);
    return decoded;
  } catch (error) {
    console.error(`error`, error);
    return null;
  }
};
